<!DOCTYPE html>
<html lang="en" class="pixel-ratio-2 retina watch-active-state">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">

    <meta name="viewport"
          content="width=device-width, initial-scale=1, maximum-scale=1, minimum-scale=1, user-scalable=no, minimal-ui">
    <meta name="mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <!--<meta content="width=device-width,initial-scale=1.0,maximum-scale=1.0,user-scalable=no" id="viewport" name="viewport">-->
    <title>青岛市贸促会2017年出国（境）展览会计划</title>
    <link rel="stylesheet" href="framework7.ios.min.css">
    <link rel="stylesheet" href="framework7.ios.colors.min.css">
    <link rel="stylesheet" href="framework7-icons.css">
    <link rel="stylesheet" href="kitchen-sink.css">
    <link rel="stylesheet" href="reset.css" type="text/css">
    <link rel="stylesheet" href="thems.css" type="text/css">
    <link rel="stylesheet" href="responsive.css" type="text/css">
    <script type="text/javascript" src="fastclick.js"></script>
    <script type="application/javascript">
        window.addEventListener("load", function () {
            FastClick.attach(document.body);
        }, false);
    </script>
    <script>
        var classArray = [];
        var placeArray = [];
        var j;
        var telArray = {
            "刘泉": "0532-83898230",
            "孙建明": "0532-83867032",
            "冯越赛": "0532-83861127",
            "沈纪东": "0532-83892360",
            "管晓华": "0532-83892371",
            "王克任": "0532-83892372",
            "郑伟": "0532-83897595"
        };
        var monthArray = ["1月", "2月", "3月", "4月", "5月", "6月", "7月", "8月", "9月", "10月", "11月", "12月"];
        window.onload = function () {
            $.getJSON("data.json", function (jsonData) {
                for (i = 0; i < jsonData.length; i++) {
                    for (j = 0; j < classArray.length; j++) {
                        if (jsonData[i]["类别"] == classArray[j])
                            break;

                    }
                    if (j == classArray.length) {
                        classArray.push(jsonData[i]["类别"]);
                    }
                }
                var classList = document.getElementById('classlistContent');
                var html = classList.innerHTML;
                for (i = 0; i < classArray.length; i++) {
                    var liFront = "<li class='accordion-item' style='background-color: white'>";
                    var itemTitle = "<a href='#' class='item-content item-link'> <div class='item-inner'> <div class='item-title'>" + classArray[i] + "</div> </div></a>";
                    html = html + liFront + itemTitle;
//                    console.log(classArray[i]);
                    var liBack = "</li>";
                    for (j = 0; j < jsonData.length; j++) {
                        if (classArray[i] == jsonData[j]["类别"]) {
                            var short;
                            if (jsonData[j]["展会名称"].indexOf("<br", 0) > 0)
                                short = jsonData[j]["展会名称"].substr(0, jsonData[j]["展会名称"].indexOf("<br", 0));
                            else
                                short = jsonData[j]["展会名称"];
                            var itemContent = "<div class='accordion-item-content'> <div class='content-block'><p onclick=display(this.id) id='" + i + "To" + j + "'><a href='javascript:void(0);'>" + short + "</a></p></div></div>"
                            html = html + itemContent;
                        }
                    }
                    classList.innerHTML = html + liBack;
                }
            });

            $.getJSON("data.json", function (jsonData) {
                var monthList = document.getElementById('monthlistContent');
                var html = monthList.innerHTML;
                for (i = 0; i < monthArray.length; i++) {

                    var liFront = "<li class='accordion-item' style='background-color: white'>";
                    var itemTitle = "<a href='#' class='item-content item-link'> <div class='item-inner'> <div class='item-title'>" + monthArray[i] + "</div> </div></a>";
                    html = html + liFront + itemTitle;
                    var liBack = "</li>";
                    for (j = 0; j < jsonData.length; j++) {
                        if (monthArray[i] == jsonData[j]["时间"].substr(0,2)) {
                            console.log(monthArray[i]);
                            var short;
                            if (jsonData[j]["展会名称"].indexOf("<br", 0) > 0)
                                short = jsonData[j]["展会名称"].substr(0, jsonData[j]["展会名称"].indexOf("<br", 0));
                            else
                                short = jsonData[j]["展会名称"];
                            var itemContent = "<div class='accordion-item-content'> <div class='content-block'><p onclick=display(this.id) id='"+i+"To"+j+"'><a href='javascript:void(0);'>" + short + "</a></p></div></div>"
                            html = html + itemContent;
                        }else if(monthArray[i] == jsonData[j]["时间"].substr(0,3)){
                            var short;
                            if (jsonData[j]["展会名称"].indexOf("<br", 0) > 0)
                                short = jsonData[j]["展会名称"].substr(0, jsonData[j]["展会名称"].indexOf("<br", 0));
                            else
                                short = jsonData[j]["展会名称"];
                            var itemContent = "<div class='accordion-item-content'> <div class='content-block'><p onclick=display(this.id) id='"+i+"To"+j+"'><a href='javascript:void(0);'>" + short + "</a></p></div></div>"
                            html = html + itemContent;
                        }
                    }
                    monthList.innerHTML = html + liBack;
                }
            });

            $.getJSON("data.json", function (jsonData) {
                for (i = 0; i < jsonData.length; i++) {
                    for (j = 0; j < placeArray.length; j++) {
                        if (jsonData[i]["地点"].indexOf("<br", 0) > 0) {
                            if (jsonData[i]["地点"].substr(0, jsonData[i]["地点"].indexOf("<br", 0)) == placeArray[j])
                                break;
                        }

                        else {
                            if (jsonData[i]["地点"] == placeArray[j])
                                break;
                        }
                    }
                    if (j == placeArray.length) {

                        if (jsonData[i]["地点"].indexOf("<br", 0) > 0)
                            placeArray.push(jsonData[i]["地点"].substr(0, jsonData[i]["地点"].indexOf("<br", 0)));
                        else
                            placeArray.push(jsonData[i]["地点"]);

                    }
                }
//                console.log(placeArray)
                var placeList = document.getElementById('placelistContent');
                var html = placeList.innerHTML;
                for (i = 0; i < placeArray.length; i++) {
                    var liFront = "<li class='accordion-item' style='background-color: white'>";
                    var itemTitle = "<a href='#' class='item-content item-link'> <div class='item-inner'> <div class='item-title'>" + placeArray[i] + "</div> </div></a>";
                    html = html + liFront + itemTitle;
//                    console.log(classArray[i]);
                    var liBack = "</li>";
                    for (j = 0; j < jsonData.length; j++) {
                        var country;
                        var city;
                        if (jsonData[j]["地点"].indexOf("<br", 0) > 0) {
                            country = jsonData[j]["地点"].substr(0, jsonData[j]["地点"].indexOf("<br", 0));
                            city = jsonData[j]["地点"].substr(jsonData[j]["地点"].indexOf("<br", 0) + 4, jsonData[j]["地点"].length - jsonData[j]["地点"].indexOf("<br", 0) - 4);
                        }
                        else {
                            country = jsonData[j]["地点"];
                            city = "";
                        }
                        if (placeArray[i] == country) {
                            var short;
                            if (jsonData[j]["展会名称"].indexOf("<br", 0) > 0)
                                short = jsonData[j]["展会名称"].substr(0, jsonData[j]["展会名称"].indexOf("<br", 0));
                            else
                                short = jsonData[j]["展会名称"];
                            var itemContent = "<div class='accordion-item-content'> <div class='content-block'><p onclick=display(this.id) id='" + i + "To" + j + "'><a href='javascript:void(0);'>" + short + "</a></p></div></div>"
                            html = html + itemContent;
                        }
                    }
                    placeList.innerHTML = html + liBack;
                }
            });
        }
    </script>
</head>
<style>
    .list-block .item-link.active-state, html:not(.watch-active-state) .list-block .item-link:active {
        background-color: white;
    }

    .fixedCon {

        background-color: aliceblue;
        border-radius: 7px;
    }

    .fixedCon img {
        background-color: grey;
    }

    .list-block {
        margin-top: 0;

    }

    .navbar-inner {
        /*padding-left: 22%;*/
    }

    .button {
        overflow: visible;
    }

    .content-block {
        margin-top: 2px;
        margin-bottom: 2px;
    }

    .telephone {
        position: relative;
        font-size: 100%;
        /*background-color: #5cb85c;color: white*/
        color: black;
        padding: 0;
    }

    .telephone div {
        font-size: 100%;
        background-color: transparent;
        /*color: #d9534f;*/
        color: green;
        padding: 0;
        margin: 0;
        border-bottom: 2px solid green;
    }
</style>
<body class="framework7-root" onclick="show_element(event)" style="line-height: 2">
<div class="navbar">
    <div class="navbar-inner">
        <div class="left"></div>
        <div class="center" style="width:100%;">
            <!-- 导航栏中的按键排控制器 -->
            <div class="buttons-row" style="width:100%;">
                <!-- 关联到第一个tab的链接，默认激活 -->
                <a href="#tab1" class="tab-link active button" >类别</a>
                <!-- 关联到第二个tab的链接 -->
                <a href="#tab2" class="tab-link button">时间</a>
                <!-- 关联到第三个tab的链接 -->
                <a href="#tab3" class="tab-link button">地点</a>
            </div>
        </div>
        <div class="right"></div>
    </div>
</div>
<div class="pages">
    <div class="page">
        <div class="page-content">
            <!-- Tabs动画容器, 在动画过渡时需要 -->
            <div class="tabs-animated-wrap">
                <!-- Tabs, tabs容器 -->
                <div class="tabs">
                    <!-- Tab 1，默认激活 -->
                    <div id="tab1" class="tab active" style="overflow: scroll">
                        <!--LIST VIEW ACCORDION-->
                        <div class="list-block accordion-list">
                            <ul id="classlistContent">
                            </ul>
                        </div>
                    </div>
                    <!-- Tab 2 -->
                    <div id="tab2" class="tab" style="overflow: scroll">
                        <div class="list-block accordion-list">
                            <ul id="monthlistContent">
                            </ul>
                        </div>
                    </div>
                    <!-- Tab 3 -->
                    <div id="tab3" class="tab" style="overflow: scroll">
                        <div class="list-block accordion-list">
                            <ul id="placelistContent">

                            </ul>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<!--SINGEL CONTENT-->
<div class="wrap" id="wrapContent">
</div>


<script>
    function display(clickId) {
        ch = clickId.split("To")
        i = ch[0];
        j = ch[1];
        $.getJSON("data.json", function (jsonData) {
            var country;
            var city;
            if (jsonData[j]["地点"].indexOf("<br", 0) > 0) {
                country = jsonData[j]["地点"].substr(0, jsonData[j]["地点"].indexOf("<br", 0));
                city = jsonData[j]["地点"].substr(jsonData[j]["地点"].indexOf("<br", 0) + 4, jsonData[j]["地点"].length - jsonData[j]["地点"].indexOf("<br", 0) - 4);
            }
            else {
                country = jsonData[j]["地点"];
                city = "";

            }
            var short;
            if (jsonData[j]["展会名称"].indexOf("<br", 0) > 0)
                short = jsonData[j]["展会名称"].substr(0, jsonData[j]["展会名称"].indexOf("<br", 0));
            else
                short = jsonData[j]["展会名称"];
            contact = "";
            if (jsonData[j]["联系人"].indexOf("<br", 0) > 0)   //2
            {
                var firstCon = jsonData[j]["联系人"].substr(0, jsonData[j]["联系人"].indexOf("<br", 0));
                var firstTel = telArray[firstCon];
                var secCon = jsonData[j]["联系人"].substr(jsonData[j]["联系人"].indexOf("<br", 0) + 4, jsonData[j]["联系人"].length - jsonData[j]["联系人"].indexOf("<br", 0) - 4);
                var secTel = telArray[secCon];
                contact = "<div style=' padding: 0;'>" + firstCon + "</div><button class='telephone' id='telephonef" + i + "'> <div style='display:block' id='telephonenumf" + i + "'>" + firstTel + "</div> </button><br>";
                contact = contact + "<div style=' padding: 0;'>" + secCon + "</div><button class='telephone' id='telephone" + i + "'> <div style='display:block' id='telephonenum" + i + "'>" + secTel + "</div> </button><br>";
            } else {         //1
                var oneCon = jsonData[j]["联系人"];
                var oneTel = telArray[oneCon];
                contact = "<div style=' padding: 0;'>" + oneCon + "</div><button class='telephone' id='telephone" + i + "'> <div style='display:block' id='telephonenum" + i + "'>" + oneTel + "</div> </button><br>";
            }
            var wrapList = document.getElementById('wrapContent');
            var wrapContent = wrapList.innerHTML;
            var wrapFont = "<div class='fixedCon dn " + i + "To" + j + "'><img class='close' id='close" + j + "' src='close.png'><div class='content'>";
            var info = "<p class='title' onclick=close()>展会信息</p><dl class='clearfix'><dt>展会名称:</dt><dd>" + jsonData[j]["展会名称"] + "</dd></dl><dl class='clearfix'><dt>时间:</dt><dd>" + jsonData[j]["时间"] + "</dd></dl><dl class='clearfix'><dt>国家:</dt><dd>" + country + "</dd></dl><dl class='clearfix'><dt>城市:</dt><dd>" + city;
            info = info + "</dd></dl><dl class='clearfix'><dt>联系人:</dt><dd>" + contact + "</dd></dl></div></div></div>";
            wrapContent = wrapContent + wrapFont + info;
            wrapList.innerHTML = wrapContent;
            aId = i + "To" + j;
            eval("$('." + aId + "').show();")
        });


//        alert(aId)
    }
    function close() {
        alert("testsetset");
    }
    function show_element() {
        if (!e) {
            var e = window.event;
        }
        //获取事件点击元素
        var targ = e.target;
        //获取元素名称
        var tname = targ.id;
//        alert(tname);
        if (tname.substr(0, 13) == "telephonenumf") {
            var clickId = tname.substr(13, tname.length - 13);
            var div = document.getElementById("telephonenumf" + clickId);
            window.open("tel:" + (div.innerHTML))
        } else if (tname.substr(0, 12) == "telephonenum") {
            var clickId = tname.substr(12, tname.length - 12);
            var div = document.getElementById("telephonenum" + clickId);
            window.open("tel:" + (div.innerHTML))
        } else if (tname.substr(0, 5) == "close") {
            $('.fixedCon').hide();
        }
    }
</script>
<script type="text/javascript" src="jquery-1.10.1.min.js"></script>
<script type="text/javascript" src="framework7.min.js"></script>
<script type="text/javascript" src="kitchen-sink.js"></script>

<!--<div class="modal-overlay"></div>-->
</body>
</html>